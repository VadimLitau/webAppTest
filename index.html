<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap"
			rel="stylesheet"
		/>

		<title>CRASH</title>
	</head>
	<body>
		<style>
			/* Reset and base styles  */
			* {
				padding: 0px;
				margin: 0px;
				border: none;
			}

			*,
			*::before,
			*::after {
				box-sizing: border-box;
			}

			/* Links */

			a,
			a:link,
			a:visited {
				text-decoration: none;
			}

			a:hover {
				text-decoration: none;
			}

			/* Common */

			aside,
			nav,
			footer,
			header,
			section,
			main {
				display: block;
			}

			h1,
			h2,
			h3,
			h4,
			h5,
			h6,
			p {
				font-size: inherit;
				font-weight: inherit;
			}

			ul,
			ul li {
				list-style: none;
			}

			img {
				vertical-align: top;
			}

			img,
			svg {
				max-width: 100%;
				height: auto;
			}

			address {
				font-style: normal;
			}

			/* Form */

			input,
			textarea,
			button,
			select {
				font-family: inherit;
				font-size: inherit;
				color: inherit;
				background-color: transparent;
			}

			input::-ms-clear {
				display: none;
			}

			button,
			input[type="submit"] {
				display: inline-block;
				box-shadow: none;
				background-color: transparent;
				background: none;
				cursor: pointer;
			}

			input:focus,
			input:active,
			button:focus,
			button:active {
				outline: none;
			}

			button::-moz-focus-inner {
				padding: 0;
				border: 0;
			}

			label {
				cursor: pointer;
			}

			legend {
				display: block;
			}
		</style>
		<style>
			body {
				font-family: "PT Sans", sans-serif;
				font-weight: 400;
				font-style: normal;
				box-sizing: border-box;
			}

			.wrap {
				display: flex;
				align-items: center;
				justify-content: center;
				height: 100vh;
				background: -webkit-linear-gradient(
					180deg,
					rgb(18, 5, 37) 73%,
					rgb(119, 0, 169)
				);
				background: -moz-linear-gradient(
					180deg,
					rgb(18, 5, 37) 73%,
					rgb(119, 0, 169)
				);
				background: linear-gradient(
					180deg,
					rgb(18, 5, 37) 73%,
					rgb(119, 0, 169)
				);
			}
			.main {
				background-image: url(./bgi.png);
				background-repeat: no-repeat;
				background-size: contain;
				background-position: center;
				width: 100vw;
				height: 100vh;
				color: aliceblue;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				position: relative;
				overflow: hidden;
			}

			.words-wrap {
				display: flex;
				flex-direction: row;
				font-family: "Roboto Mono", monospace;
				font-weight: 700;
				font-size: 88px;
				color: #ffd000;
				margin-bottom: 30px;
			}

			.word {
				display: inline-block;
				animation: wave 1.5s infinite;
			}

			.word:nth-child(1) {
				animation-delay: 0s;
			}

			.word:nth-child(2) {
				animation-delay: 0.1s;
			}

			.word:nth-child(3) {
				animation-delay: 0.2s;
			}

			.word:nth-child(4) {
				animation-delay: 0.3s;
			}

			.word:nth-child(5) {
				animation-delay: 0.4s;
			}

			@keyframes wave {
				0%,
				100% {
					transform: translateY(0);
				}
				50% {
					transform: translateY(-20px);
				}
			}

			.circle-wrap,
			.btn,
			.control-wrap {
				display: flex;
				flex-direction: column;
				align-items: center;
				/* position: relative; */
			}
			.circle-wrap {
				margin-top: 50px;
				margin-bottom: 25px;
				width: 208px;
				height: 208px;
				background-color: #600a7a;
				border-radius: 50%;
				justify-content: center;
				border: 2px solid #e6aff7;
				position: relative;
				z-index: 50;
			}
			.textWrap {
				display: flex;
				flex-direction: row;
				justify-content: center;
			}

			#circleText {
				font-size: 28px;
				color: #fff;
				text-align: center;
				margin-bottom: 10px;
			}
			#animated {
				left: 0;
				right: 0;
				/* равномерное распределение отступов */
				margin-left: auto;
				margin-right: auto;
				position: absolute;
				animation-direction: alternate;
				animation-duration: 2s;
				animation-name: move;
				animation-iteration-count: infinite;
				animation-timing-function: linear;
				z-index: 1;
			}

			#loading {
				height: 10px;
				width: 180px;
				border-radius: 25px;
				border: none;
				background: #fff;
			}

			#loading_bar {
				border-radius: 25px;
				border: none;
				width: 1%;
				height: 10px;
				background-color: #9210ba;
			}
			@keyframes move {
				from {
					left: -80%;
				}
				to {
					left: 80%;
				}
			}
			.startDisable {
				opacity: 1;
				transition: opacity 1s;
			}

			.clickEnable {
				opacity: 0;
			}
			.btn__big {
				background: -webkit-linear-gradient(
					90deg,
					rgb(96, 10, 122),
					rgb(230, 175, 247)
				);
				background: -moz-linear-gradient(
					90deg,
					rgb(96, 10, 122),
					rgb(230, 175, 247)
				);
				background: linear-gradient(
					90deg,
					rgb(96, 10, 122),
					rgb(230, 175, 247)
				);
				-moz-box-shadow: 0 0 20px #e6aff7;
				-webkit-box-shadow: 0 0 20px #e6aff7;
				box-shadow: 0 0 20px #e6aff7;
				padding: 5px 40px;
				border-radius: 25px;
			}
			.btn__big__disable {
				background: -webkit-linear-gradient(
					90deg,
					rgb(49, 49, 49),
					rgb(107, 107, 107)
				);
				background: -moz-linear-gradient(
					90deg,
					rgb(49, 49, 49),
					rgb(107, 107, 107)
				);
				background: linear-gradient(90deg, rgb(49, 49, 49), rgb(107, 107, 107));
				-moz-box-shadow: 0 0 20px rgb(107, 107, 107);
				-webkit-box-shadow: 0 0 20px rgb(107, 107, 107);
				box-shadow: 0 0 20px rgb(107, 107, 107);
			}
			.btn {
				margin-top: 25px;
				font-family: "Roboto Mono", monospace;
			}

			.btn__big {
				padding: 5px 20px;
				border-radius: 25px;
				font-size: 25px;
				font-weight: bolder;
			}
			.pulse {
				background: #d94edb;
				width: 80px;
				height: 80px;
				border-radius: 50%;
			}
			.pulse::after {
				animation-delay: 1.25s;
			}
			.pulse::before {
				content: "";
				position: absolute;
				border: 2px solid #d94edb;
				left: -20px;
				opacity: 0;
				right: -20px;
				top: -20px;
				bottom: -20px;
				border-radius: 50%;
				animation: pulse 1s linear infinite;
			}
			@keyframes pulse {
				0% {
					transform: scale(0.5);
					opacity: 0;
				}
				50% {
					opacity: 1;
				}
				100% {
					transform: scale(1.2);
					opacity: 0;
				}
			}
		</style>
		<main class="wrap">
			<section class="main">
				<div class="words-wrap">
					<p class="word">C</p>
					<p class="word">R</p>
					<p class="word">A</p>
					<p class="word">S</p>
					<p class="word">H</p>
				</div>

				<!-- <img src="./animated.png" id="animated" alt="animated" /> -->
				<div class="pulse" id="animated"></div>
				<div class="control-wrap">
					<div class="circle-wrap">
						<div class="wrapText">
							<p id="circleText">CLICK ON <br />"GET SIGNAL"</p>
						</div>
					</div>
					<div class="startDisable clickEnable" id="hidden">
						<div class="textWrap">
							<p class="seconds" id="seconds">29</p>
							<span>&nbsp; seconds</span>
						</div>
						<div class="loading" id="loading">
							<div class="loading_bar" id="loading_bar"></div>
						</div>
					</div>
					<div class="btn">
						<button class="btn__big" id="btn__big">GET SIGNAL</button>
					</div>
				</div>
			</section>
		</main>
		<script src="https://telegram.org/js/telegram-web-app.js"></script>
		<script type="text/javascript">
			let i = 0;
			function move() {
				const btn = document.getElementById("btn__big");
				let activeBtn = true;
				let time = 29;
				let width = 1;
				console.log(time, width);
				function editText() {
					if (i == 0) {
						i = 1;
						let elem = document.getElementById("loading_bar");

						let id = setInterval(frame, 300);

						function frame() {
							if (width >= 100) {
								clearInterval(id);
								i = 0;
							} else {
								width++;
								elem.style.width = width + "%";
							}
						}
					}
					const timer = setInterval(editText, 1000);

					function editText() {
						if (time >= 0) {
							document.getElementById("seconds").textContent = time;
							time--;
						}
						if (time === -1) {
							document.getElementById("seconds").textContent = 0;
							activeBtn = true;
							btn.classList.remove("btn__big__disable");
							clearInterval(timer);
						}
					}
				}
				function generateRandomNumber() {
					const min = 2;
					const max = 13;
					// Генерируем случайное число в диапазоне от 1 до 13 с тремя знаками после запятой
					let randomNum = (Math.random() * (max - min) + min).toFixed(2);
					// Приводим число к формату 1.11X (заменяем последнюю цифру на случайную цифру)
					randomNum = randomNum.slice(0, -1) + Math.floor(Math.random() * 10);
					return randomNum;
				}

				// Функция для обработки клика на кнопке
				function handleClick() {
					const number = generateRandomNumber();
					const str = number + "x";
					document.getElementById("hidden").classList.remove("clickEnable");
					document.getElementById("circleText").innerText = str;
					document.getElementById("circleText").style.fontSize = 35 + "px";
					document.getElementById("seconds").textContent = 29;
					document.getElementById("loading_bar").style.width = 1 + "%";
					width = 1;
					time = 29;
					editText();
					activeBtn = false;
					btn.classList.add("btn__big__disable");
				}

				btn.addEventListener("click", () => {
					activeBtn ? handleClick() : "";
				});
				// btn.addEventListener("click", handleClick);
			}
			move();
			// btn__big

			// генерация числа

			// Добавляем обработчик события на кнопку
		</script>
	</body>
</html>
